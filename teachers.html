<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Student Grade Sheet - Tyneceploh EF</title>
<style>
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
    max-width: 900px;
    margin: auto;
    background: #fff0f6;
    color: #4d0039;
  }
  h1 {
    text-align: center;
    margin-bottom: 5px;
  }
  #studentName {
    font-size: 1.2rem;
    font-weight: bold;
    margin-bottom: 20px;
    text-align: center;
    color: #b35979;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 15px;
  }
  th, td {
    border: 1px solid #b35979;
    padding: 6px;
    text-align: center;
  }
  th.subject-col {
    width: 150px;
    background: #f4c1d1;
  }
  input.grade-input {
    width: 50px;
    text-align: center;
    font-weight: bold;
  }
  button {
    background: #b35979;
    color: white;
    border: none;
    padding: 8px 12px;
    cursor: pointer;
    border-radius: 5px;
    margin-right: 8px;
    margin-bottom: 15px;
  }
  button:hover {
    background: #80334a;
  }
  #addSubjectBtn {
    margin-bottom: 20px;
  }
  .average-cell {
    font-weight: bold;
    background: #f9d7e0;
  }
  #totalAverageCell {
    font-weight: bold;
    font-size: 1.1rem;
    background: #eaa2b3;
  }
</style>
</head>
<body>

<h1>Student Grade Sheet</h1>
<div id="studentName">Name: <input type="text" id="studentNameInput" placeholder="Enter Student Name" /></div>

<button id="addSubjectBtn" onclick="addSubject()">➕ Add Subject</button>

<table id="gradeSheetTable">
  <thead>
    <tr>
      <th class="subject-col">Subject</th>
      <th>Period 1</th>
      <th>Period 2</th>
      <th>Period 3</th>
      <th>Period 4</th>
      <th>Period 5</th>
      <th>Period 6</th>
      <th>Average</th>
      <th>Remove</th>
    </tr>
  </thead>
  <tbody>
    <!-- Subject rows will be added here dynamically -->
  </tbody>
  <tfoot>
    <tr>
      <td colspan="7" style="text-align: right; font-weight:bold;">Total Average</td>
      <td id="totalAverageCell">-</td>
      <td></td>
    </tr>
  </tfoot>
</table>

<script>
  const tbody = document.querySelector("#gradeSheetTable tbody");
  let subjectCount = 0;

  function addSubject() {
    subjectCount++;
    const tr = document.createElement("tr");

    // Subject Name cell with input
    const subjectTd = document.createElement("td");
    const subjectInput = document.createElement("input");
    subjectInput.type = "text";
    subjectInput.placeholder = `Subject ${subjectCount}`;
    subjectInput.style.width = "90%";
    subjectTd.appendChild(subjectInput);
    tr.appendChild(subjectTd);

    // Create 6 period grade input cells
    for (let i = 1; i <= 6; i++) {
      const gradeTd = document.createElement("td");
      const gradeInput = document.createElement("input");
      gradeInput.type = "number";
      gradeInput.min = 60;
      gradeInput.max = 100;
      gradeInput.className = "grade-input";
      gradeInput.addEventListener("input", () => updateRowAverage(tr));
      gradeTd.appendChild(gradeInput);
      tr.appendChild(gradeTd);
    }

    // Average cell
    const avgTd = document.createElement("td");
    avgTd.className = "average-cell";
    avgTd.textContent = "-";
    tr.appendChild(avgTd);

    // Remove button cell
    const removeTd = document.createElement("td");
    const removeBtn = document.createElement("button");
    removeBtn.textContent = "🗑️";
    removeBtn.style.background = "#cc4444";
    removeBtn.onclick = () => {
      tr.remove();
      updateTotalAverage();
    };
    removeTd.appendChild(removeBtn);
    tr.appendChild(removeTd);

    tbody.appendChild(tr);
  }

  function updateRowAverage(row) {
    let total = 0;
    let count = 0;
    for (let i = 1; i <= 6; i++) {
      const input = row.cells[i].querySelector("input");
      if (!input) continue;
      const val = parseFloat(input.value);
      if (!isNaN(val) && val >= 60 && val <= 100) {
        total += val;
        count++;
      }
    }
    const avgCell = row.cells[7];
    if (count === 0) {
      avgCell.textContent = "-";
    } else {
      const avg = total / count;
      avgCell.textContent = avg.toFixed(2);
    }
    updateTotalAverage();
  }

  function updateTotalAverage() {
    let totalAvgSum = 0;
    let subjectWithAvgCount = 0;

    tbody.querySelectorAll("tr").forEach(row => {
      const avgText = row.cells[7].textContent;
      const avgVal = parseFloat(avgText);
      if (!isNaN(avgVal)) {
        totalAvgSum += avgVal;
        subjectWithAvgCount++;
      }
    });

    const totalAvgCell = document.getElementById("totalAverageCell");
    if (subjectWithAvgCount === 0) {
      totalAvgCell.textContent = "-";
    } else {
      totalAvgCell.textContent = (totalAvgSum / subjectWithAvgCount).toFixed(2);
    }
  }
</script>

</body>
</html>
