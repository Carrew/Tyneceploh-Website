<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Teacher Portal</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f4f4f4;
    }
    h2 {
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: #fff;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #eee;
    }
    button {
      margin: 10px 5px;
      padding: 8px 12px;
      cursor: pointer;
    }
    #logout {
      float: right;
      background-color: crimson;
      color: white;
    }
    .avg {
      font-weight: bold;
    }
    .blue {
      color: blue;
    }
    .red {
      color: red;
    }
  </style>
</head>
<body>
  <h2>Welcome, Teacher</h2>
  <button onclick="addSubject()">âž• Add Subject</button>
  <button onclick="addStudent()">âž• Add Student</button>
  <button onclick="saveDraft()">ðŸ’¾ Save as Draft</button>
  <button id="logout" onclick="confirmLogout()">ðŸšª Logout</button>  <table id="gradeTable">
    <tr>
      <th>Student Name</th>
      <th>Subject 1</th>
      <th>Average</th>
      <th>Rank</th>
    </tr>
    <tr>
      <td><input placeholder="Student 1"></td>
      <td><input type="number" min="60" max="100" oninput="updateAverage(1)"></td>
      <td class="avg">-</td>
      <td class="rank">-</td>
    </tr>
  </table>  <script>
    let studentCount = 1;
    let subjectCount = 1;

    function addSubject() {
      subjectCount++;
      const table = document.getElementById("gradeTable");
      const headerRow = table.rows[0];
      const avgIndex = headerRow.cells.length - 2;

      const newHeader = document.createElement("th");
      newHeader.innerText = `Subject ${subjectCount}`;
      headerRow.insertBefore(newHeader, headerRow.cells[avgIndex]);

      for (let i = 1; i < table.rows.length; i++) {
        const row = table.rows[i];
        const inputCell = document.createElement("td");
        const input = document.createElement("input");
        input.type = "number";
        input.min = 60;
        input.max = 100;
        input.oninput = () => updateAverage(i);
        inputCell.appendChild(input);
        row.insertBefore(inputCell, row.cells[avgIndex]);
      }
    }

    function addStudent() {
      studentCount++;
      const table = document.getElementById("gradeTable");
      const row = table.insertRow(-1);
      const nameCell = row.insertCell(0);
      const nameInput = document.createElement("input");
      nameInput.placeholder = `Student ${studentCount}`;
      nameCell.appendChild(nameInput);

      for (let j = 0; j < subjectCount; j++) {
        const gradeCell = row.insertCell(-1);
        const input = document.createElement("input");
        input.type = "number";
        input.min = 60;
        input.max = 100;
        input.oninput = () => updateAverage(table.rows.length - 1);
        gradeCell.appendChild(input);
      }

      const avgCell = row.insertCell(-1);
      avgCell.className = "avg";
      const rankCell = row.insertCell(-1);
      rankCell.className = "rank";
      updateAllAverages();
    }

    function updateAverage(rowIndex) {
      const table = document.getElementById("gradeTable");
      const row = table.rows[rowIndex];
      let total = 0;
      let count = 0;
      for (let i = 1; i <= subjectCount; i++) {
        const input = row.cells[i].querySelector("input");
        const val = parseFloat(input.value);
        if (!isNaN(val)) {
          total += val;
          count++;
        }
      }
      const avg = count ? (total / count).toFixed(2) : "-";
      const avgCell = row.cells[row.cells.length - 2];
      avgCell.textContent = avg;

      if (avg !== "-" && avg < 70) {
        avgCell.classList.add("red");
        avgCell.classList.remove("blue");
      } else {
        avgCell.classList.add("blue");
        avgCell.classList.remove("red");
      }

      updateRanks();
    }

    function updateAllAverages() {
      const table = document.getElementById("gradeTable");
      for (let i = 1; i < table.rows.length; i++) {
        updateAverage(i);
      }
    }

    function updateRanks() {
      const table = document.getElementById("gradeTable");
      let averages = [];
      for (let i = 1; i < table.rows.length; i++) {
        const avgText = table.rows[i].cells[table.rows[i].cells.length - 2].textContent;
        const avg = parseFloat(avgText);
        if (!isNaN(avg)) {
          averages.push({ index: i, avg: avg });
        }
      }
      averages.sort((a, b) => b.avg - a.avg);
      averages.forEach((entry, rank) => {
        const rankCell = table.rows[entry.index].cells[table.rows[entry.index].cells.length - 1];
        rankCell.textContent = rank + 1;
      });
    }

    function confirmLogout() {
      if (confirm("Are you sure you want to logout?")) {
        window.location.href = "index.html";
      }
    }

    function saveDraft() {
      alert("Draft saved locally. Later this will store to the backend.");
    }
  </script></body>
</html>
